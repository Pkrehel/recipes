<!DOCTYPE html>
<html>

<head>
  <title>Homepage</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="/stylesheets/main.css">
  <link rel="stylesheet" type="text/css" href="/stylesheets/custom.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css?family=Nunito:300,400,600,700|Roboto:300,400,500" rel="stylesheet">
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
  <script src="https://cdn.tiny.cloud/1/a5dmcvc482cq0zqorxvkxjzewccn4q6fdvw6lday1s4jdoyv/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
  
  <style>
  #cooking-container{
    height: 100%;
    width: 100%;
    display: none;
    text-align: center;
    background-color: #ffde6b;
  }
  #cooking h4 {
    position: relative;
    margin: 0 auto;
    top: 25vh;
    text-align: center;
    font-family: "Amatic SC";
    font-size: 2vh;
    color: #333;
    opacity: 0.75;
    animation: pulse 2.75s linear infinite;
  }
  #cooking {
    width: 50%;
    max-width: 600px;
    display: inline-block;
    text-align: center;
    position: relative;
    margin: 0 auto;
    top: 25vh;
    height: 45vh;
    overflow: hidden;
  }
  #cooking .bubble {
    position: absolute;
    border-radius: 100%;
    box-shadow: 0 0 0.25vh #4d4d4d;
    opacity: 0;
  }
  #cooking .bubble:nth-child(1) {
    margin-top: 2.5vh;
    left: 58%;
    width: 2.5vh;
    height: 2.5vh;
    background-color: #454545;
    animation: bubble 2s cubic-bezier(0.53, 0.16, 0.39, 0.96) infinite;
  }
  #cooking .bubble:nth-child(2) {
    margin-top: 3vh;
    left: 52%;
    width: 2vh;
    height: 2vh;
    background-color: #3d3d3d;
    animation: bubble 2s ease-in-out 0.35s infinite;
  }
  #cooking .bubble:nth-child(3) {
    margin-top: 1.8vh;
    left: 50%;
    width: 1.5vh;
    height: 1.5vh;
    background-color: #333;
    animation: bubble 1.5s cubic-bezier(0.53, 0.16, 0.39, 0.96) 0.55s infinite;
  }
  #cooking .bubble:nth-child(4) {
    margin-top: 2.7vh;
    left: 56%;
    width: 1.2vh;
    height: 1.2vh;
    background-color: #2b2b2b;
    animation: bubble 1.8s cubic-bezier(0.53, 0.16, 0.39, 0.96) 0.9s infinite;
  }
  #cooking .bubble:nth-child(5) {
    margin-top: 2.7vh;
    left: 63%;
    width: 1.1vh;
    height: 1.1vh;
    background-color: #242424;
    animation: bubble 1.6s ease-in-out 1s infinite;
  }
  #cooking #area {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 50%;
    height: 50%;
    background-color: transparent;
    transform-origin: 15% 60%;
    animation: flip 2.1s ease-in-out infinite;
  }
  #cooking #area #sides {
    position: absolute;
    width: 100%;
    height: 100%;
    transform-origin: 15% 60%;
    animation: switchSide 2.1s ease-in-out infinite;
  }
  #cooking #area #sides #handle {
    position: absolute;
    bottom: 18%;
    right: 80%;
    width: 35%;
    height: 20%;
    background-color: transparent;
    border-top: 1vh solid #333;
    border-left: 1vh solid transparent;
    border-radius: 100%;
    transform: rotate(20deg) rotateX(0deg) scale(1.3, 0.9);
  }
  #cooking #area #sides #pan {
    position: absolute;
    bottom: 20%;
    right: 30%;
    width: 50%;
    height: 8%;
    background-color: #333;
    border-radius: 0 0 1.4em 1.4em;
    transform-origin: -15% 0;
  }
  #cooking #area #pancake {
    position: absolute;
    top: 24%;
    width: 100%;
    height: 100%;
    transform: rotateX(85deg);
    animation: jump 2.1s ease-in-out infinite;
  }
  #cooking #area #pancake #pastry {
    position: absolute;
    bottom: 26%;
    right: 37%;
    width: 40%;
    height: 45%;
    background-color: #333;
    box-shadow: 0 0 3px 0 #333;
    border-radius: 100%;
    transform-origin: -20% 0;
    animation: fly 2.1s ease-in-out infinite;
  }

  @keyframes jump {
    0% {
      top: 24%;
      transform: rotateX(85deg);
    }
    25% {
      top: 10%;
      transform: rotateX(0deg);
    }
    50% {
      top: 30%;
      transform: rotateX(85deg);
    }
    75% {
      transform: rotateX(0deg);
    }
    100% {
      transform: rotateX(85deg);
    }
  }
  @keyframes flip {
    0% {
      transform: rotate(0deg);
    }
    5% {
      transform: rotate(-27deg);
    }
    30%,
    50% {
      transform: rotate(0deg);
    }
    55% {
      transform: rotate(27deg);
    }
    83.3% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(0deg);
    }
  }
  @keyframes switchSide {
    0% {
      transform: rotateY(0deg);
    }
    50% {
      transform: rotateY(180deg);
    }
    100% {
      transform: rotateY(0deg);
    }
  }
  @keyframes fly {
    0% {
      bottom: 26%;
      transform: rotate(0deg);
    }
    10% {
      bottom: 40%;
    }
    50% {
      bottom: 26%;
      transform: rotate(-190deg);
    }
    80% {
      bottom: 40%;
    }
    100% {
      bottom: 26%;
      transform: rotate(0deg);
    }
  }
  @keyframes bubble {
    0% {
      transform: scale(0.15, 0.15);
      top: 80%;
      opacity: 0;
    }
    50% {
      transform: scale(1.1, 1.1);
      opacity: 1;
    }
    100% {
      transform: scale(0.33, 0.33);
      top: 60%;
      opacity: 0;
    }
  }
  @keyframes pulse {
    0% {
      transform: scale(1, 1);
      opacity: 0.25;
    }
    50% {
      transform: scale(1.2, 1);
      opacity: 1;
    }
    100% {
      transform: scale(1, 1);
      opacity: 0.25;
    }
  }
</style>
</head>

<body>

<div id="cooking-container">
  <div id="cooking">
  <div class="bubble"></div>
  <div class="bubble"></div>
  <div class="bubble"></div>
  <div class="bubble"></div>
  <div class="bubble"></div>
  <div id="area">
    <div id="sides">
      <div id="pan"></div>
      <div id="handle"></div>
    </div>
    <div id="pancake">
      <div id="pastry"></div>
    </div>
  </div>
      <h4>Uploading Your Recipe...</h4>
</div>
</div>

  <div id="fullPageHide">
  <div class="container">
    <nav class="navbar navbar-expand-md fixed-top-sm justify-content-start flex-nowrap bg-light navbar-light pl-0 pr-0">
  <a href="/" class="navbar-brand">
    <% if(!currentUser) { %>
    Recipes 
    <% } %>
    <% if(currentUser) { %>
   <%= currentUser.firstName %>'s Recipes <%= currentUser.avatar %>
    <% } %>
  </a>
  
  <!--SIGN UP / LOGIN BUTTON-->
  <% if(!currentUser) { %>
  <a href="#0" class="btn btn-outline-primary ml-auto d-none d-sm-block js-cd-panel-trigger" data-panel="main">
    <i class="far fa-user-circle"></i> Sign Up / Login</a>
    <% } %>
      <% if(currentUser) { %>
      <div class="ml-auto">
      <form class="form-inline d-none d-md-block">
        
        <div class="dropdown d-inline">
          <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Profile</button>
          <div class="dropdown-menu text-center p-2" aria-labelledby="dropdownMenu2">
            <a href="/users/<%= currentUser.id %>" class="mb-2 btn btn-outline-dark w-100">View Profile</a>
            <a href="/logout" class="btn btn-outline-danger w-100">Logout</a>
          </div>
        </div>
          <a href="/recipes/new">
             <div class="btn btn-outline-primary ml-4">Post A Recipe</div>
          </a>
      </form>
      </div>
  <% } %>  
    <button class="navbar-toggler ml-auto border-0" type="button" data-toggle="collapse" data-target="#navbar2">
        <i class="fa fa-search"></i>
    </button>
</nav>
    <nav class="navbar navbar-expand-md bg-light navbar-light p-0">
      <div class="navbar-collapse collapse pt-2 pt-md-0" id="navbar2"> 
      <ul class="navbar-nav">
        <li class="nav-item mb-2 mr-2">
          <form action="/s" class="form-inline" method="GET">
            <div class="input-group">
                <div id="input_container">
                  <input class="form-control" id="searchbar" name="search" type="search" placeholder="Search Recipes " aria-label="Search">
                  <i class="fa fa-search search-icon"></i>
                </div>

                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary text-dark" value="Search" type="submit">Search</button>
                  </div>
                </div>
          </form>
        </li>
        <li class="nav-item dropdown megamenu-li">
          <a class="nav-link btn btn-outline-primary dropdown-toggle" href="" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Categories</a>
          <div class="dropdown-menu megamenu bg-light border border-secondary" aria-labelledby="dropdown01">
              <div class="row">
               <div class="col-sm-6 col-lg-3 mb-2">
                <h5>Diet Type</h5>
                <a class="dropdown-item" href="/?allergens=Vegetarian&pageTitle=Vegetarian Recipes">Vegetarian</a>
                <a class="dropdown-item" href="/?allergens=Vegan&pageTitle=Vegan Recipes">Vegan</a>
                <a class="dropdown-item" href="/?allergens=Gluten-Free&pageTitle=Gluten-Free Recipes">Gluten-Free</a>
               </div>
               <div class="col-sm-6 col-lg-3 mb-2">
                <h5>Time of Day</h5>
                <a class="dropdown-item" href="/?category=Breakfast&pageTitle=Breakfast Recipes">Breakfast</a>
                <a class="dropdown-item" href="/?category=Lunch&pageTitle=Lunch Recipes">Lunch</a>
                <a class="dropdown-item" href="/?category=Dinner&pageTitle=Dinner Recipes">Dinner</a>
               </div>
               <div class="col-sm-6 col-lg-3 mb-2">
                <h5>Difficulty</h5>
                <a class="dropdown-item" href="/?difficulty=0&pageTitle=Beginner Recipes">Beginner</a>
                <a class="dropdown-item" href="/?difficulty=1&pageTitle=Intermediate Recipes">Intermediate</a>
                <a class="dropdown-item" href="/?difficulty=2&pageTitle=Challenging Recipes">Challenging</a>
               </div>
               <div class="col-sm-6 col-lg-3 mb-2">
                <h5>Kitchen Time</h5>
                <a class="dropdown-item" href="/?lt=11&pageTitle=Quick Recipes">Quick <span class="small">(10 minutes or less)</span></a>
                 <a class="dropdown-item" href="/?lt=46&gt=11&pageTitle=Medium Recipes">Medium <span class="small">(11-45 minutes)</span></a>
                 <a class="dropdown-item" href="/?gt=46&pageTitle=Long Recipes">Long <span class="small">(> 45 minutes)</span></a>
               </div>
              </div>
               <hr>
               <div class="row">
                 <div class="col-sm-6 col-lg-3 mb-2"><a href="/?sortBy=-1&orderBy=createdAt&pageTitle=Recent Recipes">Recent</a></div>
                 <div class="col-sm-6 col-lg-3 mb-2"><a href="/?sortBy=-1&orderBy=views&pageTitle=Most Viewed Recipes">Most Viewed</a></div>
                 <div class="col-sm-6 col-lg-3 mb-2"><a href="/?sortBy=-1&orderBy=rating&pageTitle=Highest Rated Recipes">Highest Rating</a></div>
                 <div class="col-sm-6 col-lg-3 mb-2"><a href="/recipes/new" class="btn btn-primary">Post A New Recipe</a></div>
               </div>
             </div>
        </li>
      </ul>
    </div>
    </nav>
</div>
  <div class="container">
    <div class="row">
      <div class="col-md-12 m-2">
        <div class="alert-container">
        <% if(error && error.length > 0) { %>
          <div class="alert alert-danger m-0 p-1 w-100" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">x</button>
            <p class="mb-0 text-center">
              <%= error %>
            </p>
          </div>
          <% } %>
            <% if(error && success.length > 0) { %>
              <div class="alert alert-success m-0 p-1 w-100" role="alert">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">x</button>
                <p class="mb-0 text-center">
                  <%= success %>
                </p>
              </div>
            <% } %>
        </div>
      </div>
    </div>
  </div>
  <!--END OF (SECONDARY NAV)-->

  <!--SLIDING MENU BAR-->
  <!--NO CURRENT USER - SIGN UP SLIDEOUT-->
  <%if(!currentUser) { %>
    <div class="cd-panel cd-panel--from-right js-cd-panel-main">
      <div class="container">
        <header class="cd-panel__header">
          <!--Create Account / Login Buttons-->
          <div class="container">
            <div class="row text-center">
              <div class="col-6 accountToggleButton">
                <h1>Sign Up</h1>
              </div>
              <div class="col-6 accountToggleButton">
                <h1>Login</h1>
              </div>
            </div>
            <a href="#0" class="cd-panel__close js-cd-close">Close</a>
          </div>
        </header>
      </div>
      <div class="cd-panel__container">
        <div class="cd-panel__content">

          <!--SIGN UP FORM-->
          <div class="accountToggleContainer">
            <h4 class="text-center font-weight-bold text-primary">Sign Up</h4>
            <div class="dropdown-divider"></div>
            <form action="/register" method="POST">
              <div class="form-group text-dark"> <label>First Name</label>
                <input type="text text-dark" name="firstName" class="form-control" placeholder="First Name" minlength="1" maxlength="50" , required>
              </div>
              <div class="form-group text-dark"> <label>Username</label>
                <input type="text text-dark" name="screenName" class="form-control" placeholder="different from email" minlength="4" maxlength="30" , required>
              </div>
              <div class="form-group text-dark" required><label>Email address</label>
                <input type="email" name="username" class="form-control text-dark" required>
              </div>
              <div class="form-group text-dark"> <label>Password</label>
                <input type="password" name="password" class="form-control" placeholder="Password" autocomplete=off>
              </div>
              <div class="form-group avatars text-dark"> <label>Choose an Avatar</label>
                <div class="btn-group btn-group-toggle row" data-toggle="buttons">
                  <div class="col-xs-1">
                    <label class="btn avatar">
                    <input type="radio" name="avatar" value="😛" autocomplete="off">😛
                  </label>
                  </div>
                  <div class="col-xs-1">
                    <label class="btn avatar">
                    <input type="radio" name="avatar" value="😎" autocomplete="off">😎
                    </label>
                  </div>
                  <div class="col-xs-1">
                    <label class="btn avatar">
                    <input type="radio" name="avatar" value="🍉" autocomplete="off">🍉
                  </label>
                  </div>
                  <div class="col-xs-1">
                    <label class="btn avatar">
                    <input type="radio" name="avatar" value="🌶" autocomplete="off">🌶
                  </label>
                  </div>
                  <div class="col-xs-1">
                    <label class="btn avatar">
                    <input type="radio" name="avatar" value="🍅" autocomplete="off">🍅
                  </label>
                  </div>
                  <div class="col-xs-1">
                    <label class="btn avatar">
                    <input type="radio" name="avatar" value="🍍" autocomplete="off">🍍
                  </label>
                  </div>
                  <div class="col-xs-1">
                    <label class="btn avatar">
                    <input type="radio" name="avatar" value="🍄" autocomplete="off">🍄
                  </label>
                  </div>
                  <div class="col-xs-1">
                    <label class="btn avatar">
                    <input type="radio" name="avatar" value="🍲" autocomplete="off">🍲
                  </label>
                  </div>
                  <div class="col-xs-1">
                    <label class="btn avatar">
                    <input type="radio" name="avatar" value="☕" autocomplete="off">☕
                  </label>
                  </div>
                  <div class="col-xs-1">
                    <label class="btn avatar">
                    <input type="radio" name="avatar" value="🍜" autocomplete="off">🍜
                  </label>
                  </div>
                  <div class="col-xs-1">
                    <label class="btn avatar">
                    <input type="radio" name="avatar" value="🍷" autocomplete="off">🍷
                    </label>
                  </div>
                </div>
              </div>
              <button type="submit" class="btn btn-secondary btn-block btn-lg my-2"><b>Create Account</b></button>
            </form>
          </div>

          <!--LOGIN FORM:-->
          <div class="accountToggleContainer" style="display: none">
            <h4 class="text-center font-weight-bold text-primary">Login</h4>
            <div class="dropdown-divider"></div>
            <form class="px-1 py-2" action="/login" method="POST">
              <div class="form-group">
                <label for="nav-dropdown-email">Email</label>
                <input type="email" class="form-control" id="nav-dropdown-email" name="username" required>
              </div>
              <div class="form-group">
                <label for="nav-dropdown-password">Password</label>
                <input type="password" class="form-control" id="nav-dropdown-password" name="password" placeholder="Password" autocomplete=off required>
              </div>
              <div class="w-100">
                <button type="submit" class="btn btn-secondary btn-block btn-lg my-2"><b>Sign In</b></button>
              </div>
            </form>
            <div class="small">
              <p class="text-center">Don't have an account? <b><a href="/register">Create Profile</a></b></p>
              <p class="text-center">Forgot your password? <b><a href="/forgot">Reset Password</a></b></p>
            </div>
            <div class="dropdown-divider"></div>
          </div>
        </div>
      </div>
    </div>
  <% } %>
  <!-- cd-panel -->

    <!--CURRENT USER - Recipe Book-->
    <%if(currentUser) { %>
      <div class="cd-panel cd-panel--from-right js-cd-panel-main container">
        <!--Top Header Container-->
        <div class="row">
          <header class="cd-panel__header container">
            <!--Top Header-->
              <div class="col-12 text-center">
                <h1>Favorite Recipes</h1>
              </div>
              <a href="#0" class="cd-panel__close js-cd-close">Close</a>
          </header>
        </div>

          <div class="cd-panel__container">
            <div class="cd-panel__content">
                <div class="row">
                    <div class="col-12">
                        <div class="container">
                                  <div class="row">
                                  <% if(currentUser.lovedRecipes.length === 0) { %>
                                  <p>You have not favorited any recipes yet! Click the <span><i class="fas fa-heart"></i></span> icon to favorite a recipe.</p>
                                    <% } %>
                                  <% if(currentUser.lovedRecipes.length > 0) { %>
                                  <% for(var i = 0; i < currentUser.lovedRecipes.length; i++) { %>
                                      <div class="col-xs-12 col-sm-6 mb-3">
                                          <div class="card card-light w-100">
                                            <div class="img-container">
                                              <img class="card-img-top smallImageSlideout" src="<%= currentUser.lovedRecipes[i].image %>">
                                              <div class="recipeBookButton text-center">
                                                <form action="/recipes/<%=currentUser.lovedRecipes[i]._id %>/love?_method=DELETE" method="POST">
                                                  <button type="submit" class="btn rounded-circle like-btn-homepage">
                                                  <i class="fas fa-heart-broken"></i>
                                                  </button>
                                                </form>
                                            </div>
                                              </div>
                                              <div class="card-body smallImageSlideoutBody px-1 py-2 text-center">
                                                  <h5 class="card-title"><%= currentUser.lovedRecipes[i].title %></h5>
                                                  <h6 class="card-subtitle mb-2 text-muted"><i class="far fa-clock"></i>&nbsp;<%= currentUser.lovedRecipes[i].totalTime %> minutes</h6>
                                                    <form action="/recipes/<%= currentUser.lovedRecipes[i]._id %>" method="GET">
                                                      <button class="btn btn-outline-primary text-center btn-block recipe-view-button my-1">View</button>
                                                    </form>
                                              </div>
                                          </div>
                                      </div>
                                  <% } %>
                                  <% } %>
                                  </div>
                              </div>
                    </div>
                </div>
                <div class="row" id="invisible-sliding-footer"></div>
            <!--Sliding Menu Footer-->
              <div class="slider-footer-container">
                <div class="slider-footer-contents container">
                  <div class="row">
                    <div class="col-12">
                      <a href="/logout" class="btn btn-outline-danger btn-block btn-lg my-2">Logout</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>

          </div>
      </div>
    <% } %>
    <main role="main" class="container mt-3">